<html>
<head>
<meta name="viewport" content="width=device-width, user-scalable=no">
<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
<script src="./dist/gyronorm.complete.min.js"></script>


</head>

<body onload="init_gn()">

  <div class="container">
    <input type="text" style="font-size: 60px; width: 150px" class="form-control" id="dm_gx" disabled>
  </div>

  <button id="request"> 
    Ask permissions
  </button>

  <script type="text/javascript">
    
    function permission () {
    if ( typeof( DeviceMotionEvent ) !== "undefined" && typeof( DeviceMotionEvent.requestPermission ) === "function" ) {
        // (optional) Do something before API request prompt.
        DeviceMotionEvent.requestPermission()
            .then( response => {
            // (optional) Do something after API prompt dismissed.
            if ( response == "granted" ) {
                window.addEventListener( "devicemotion", (e) => {
                    // do something for 'e' here.
                    start_gn();
                  })
            }
        })
            .catch( console.error )
    } else {
        alert( "DeviceMotionEvent is not defined" );
    }
}
  const btn = document.getElementById( "request" );
  btn.addEventListener( "click", permission );
    
    
    var gn;

    function init_gn() {
      var args = {
         
      };

      gn = new GyroNorm();

      gn.init(args).then(function() {
        var isAvailable = gn.isAvailable();
        start_gn();
      }).catch(function(e){

        console.log(e);
        
      });
    }
 
    function start_gn() {
      gn.start(gnCallBack);
    }

    function gnCallBack(data) {
      $('#dm_gx').val(data.dm.gx);
    }


  </script>
</body>

</html>
